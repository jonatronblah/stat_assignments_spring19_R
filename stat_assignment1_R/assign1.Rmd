---
title: "Stat Spring 2019 Assignment 1"
author: "Jonathan Scheer"
date: "January 13, 2019"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
candyBars <- read_csv('C:/Users/jonathan/Desktop/DAPT Docs/spring 2019/Statistics/stat_assignments_spring19_R/stat_assignment1_R/data/CandyBars.txt')
library(corrplot)
library(ggplot2)
```

# Part 1

1. Consider all of the numeric variables (i.e. all of the variables except Brand and Name):
Determine the variance/covariance matrix and the correlation matrix of these variables.
Interpret briefly what you see. 
2. Construct a scatterplot matrix of the variables specified in #1. Comment on what you
observe.
3. Construct a color map on correlations for the variables specified in #1. Comment on what
you observe. 
4. Use a probability plot to assess the multivariate normality of the variables specified in #1.
Interpret. 


```{r co-matrix}
#subset numeric variables
candyBars_sub <- candyBars %>% 
  select_if(is.numeric)
#Get co/variance matrix
candyBars_cov <- cov(candyBars_sub)
candyBars_cov
#Scatterplot matrix of covariance
pairs(~., data=candyBars_cov)

#Get correlation matrix
candyBars_corr <- cor(candyBars_sub)
candyBars_corr
#correlation matrix by color
corrplot(candyBars_corr, method='color')
#Probability plot
candyBars_mtx <- as.matrix(candyBars_sub)
candyBars_centroid <- colMeans(candyBars_mtx)
n <- nrow(candyBars_mtx) 
p <- ncol(candyBars_mtx)
cov <- cov(candyBars_mtx)
distances <- mahalanobis(candyBars_mtx, candyBars_centroid, cov)
qqplot(qchisq(ppoints(n),df=p),distances,
       main="QQ Plot Assessing Multivariate Normality",
       ylab="Mahalanobis D2")
abline(a=0,b=1)
#to do: try adding ggplot with more detail/better formatting!

```

# Part II

Reconsider the candy bar data. Perform a Principal Component Analysis on this data by carrying out
the following steps:
a) i) Find and display the eigenvalues of the correlation matrix. Use these along with a Scree plot (and/or
other means) to determine the number of principal components that are to be retained. How much of the
variation in the data is explained by your chosen number of principal components? Remember that your
goal is dimension reductionâ€¦so please be sensible in your choice of number of components. 

```{r pca corr}
#by Eigenvalues
candyBarsEV <- eigen(candyBars_corr)
summary(candyBarsEV$values)
plot(candyBarsEV$values, type='l')

#by variance
candyPCA <- prcomp(candyBars_sub, scale=TRUE)
summary(candyPCA)
plot(candyPCA, type='l')

#loadings
candyLoadings <- candyPCA$rotation
candyLoadings

#biplot
candyBar_scores <- as.data.frame(candyPCA$x)
p <- ggplot(data=candyBar_scores, aes(x=PC1, y=PC2,colour=candyBars$Brand)) 
p + geom_hline(yintercept=0) + geom_vline(xintercept=0) + geom_point()
```

```{r pca cov}
#by Eigenvalues
candyBarsEV <- eigen(candyBars_cov)
summary(candyBarsEV$values)
plot(candyBarsEV$values, type='l')

#by variance
candyPCA_cov <- prcomp(candyBars_sub, scale=FALSE)
summary(candyPCA_cov)
plot(candyPCA_cov, type='l')

#loadings
candyLoadings <- candyPCA_cov$rotation
candyLoadings

#biplot
candyBar_cov_scores <- as.data.frame(candyPCA_cov$x)
p <- ggplot(data=candyBar_cov_scores, aes(x=PC1, y=PC2,colour=candyBars$Brand)) 
p + geom_hline(yintercept=0) + geom_vline(xintercept=0) + geom_point()
```


